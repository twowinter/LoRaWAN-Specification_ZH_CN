## 第12章 信标的获得和追踪

在从 Class A 切换到 Class B 之前，终端必须首先接收一个网络的信标来将它自身的时间基准与网络时间进行校准。

一旦处于 Class B 模式，终端必须定期地去搜索并且接收一个网络信标，以消除自身内部基准时间相对于网络时间的任何漂移。

Class B 模式的设备也许会短暂性地无法接收信标(超出与网关的通信范围，存在干扰，...）在这种情况之下，终端必须考虑它内部时钟可能产生的漂移，逐步地加大信标和ping时隙的接收窗口时间。

> 例如，一个设备精度为 10ppm 的内部时钟每个信标周期(128s)就会有+/-1.3ms的漂移。

### <a name="12.1">12.1 最小 beacon-less 操作时间</a>

在信标丢失的情况之下，一个终端需要在接收到最后一个信标节点时间开始算起保持2小时的 Class B 操作。这种短暂的没有信标的 Class B 操作就称之为 “beacon-less” 操作。这种情况之下就需要依赖终端自己的时钟来保持时间。

在 “beacon-less” 的情况下，单播、多播还有信标接收时隙都必须逐步地扩大接收窗口时间以容纳终端可能的时钟漂移。

![](/img/beacon-less_temporary_operation.png)

### <a name="12.2">12.2 beacon-less 接收操作的延长</a>

在120分钟的时间间隔之内，一旦终端接收到任何信标，就需要将 Class B 的 “beacon-less” 操作进一步延长120分钟，使得终端可以校正时序漂移以及重置接收时隙持续时间。

### <a name="12.3">12.3 减少时序漂移</a>

终端可以使用信标的准确周期(当信标可用时)去校准他们的初始化时钟，这样可以减少初始化时钟频率的不准确性。由于定时振荡器会表示出可预知的温度漂移，因此使用温度传感器可以尽可能地减小时序漂移。